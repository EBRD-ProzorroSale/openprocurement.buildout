[buildout]
extensions = mr.developer
package-name = openprocurement.api
auto-checkout = ${:package-name}
parts =
    scripts
    couchpy
    circusd
    circus.ini
    couchdb.ini
eggs =
    cornice
    chaussette
    gevent
    circus
    circus-web
    pyramid
    ${:package-name}

[sources]
openprocurement.api = git git@github.com:openprocurement/openprocurement.api.git

[config-from-template]
recipe = collective.recipe.template[genshi]:genshi
input = templates/${:_buildout_section_name_}
output = etc/${:_buildout_section_name_}

[scripts]
recipe = zc.recipe.egg
eggs = ${buildout:eggs}
scripts =
    chaussette
    circusd-stats
    circus-top
    circusctl
    circus-plugin
    circushttpd

[couchpy]
<=scripts
eggs = CouchDB
scripts = couchpy

[circusd]
<=scripts
interpreter = python
initialization =
    sys.argv[1:1] = ('${buildout:directory}/etc/circus.ini').split()
scripts = circusd

[circus.ini]
<= config-from-template

[couchdb.ini]
<= config-from-template
